<!DOCTYPE html>

<html lang="en">

	<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, width=device-width">
    <title>TrkFin{% block title %}{% endblock %}</title>
    
    <!-- Bootstrap https://getbootstrap.com/docs/5.1 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
    
    <link href="/static/favicon.png" rel="icon">
    <link href="/static/styles.css" rel="stylesheet">
    <script src="/static/scripts.js" defer></script>

    {% block head %}{% endblock %}
  </head>

	<body>

		<nav class="navbar" data-navbar>
      <a class="nav-brand" href="{{ url_for('index') }}">TrkFin</a>
      <div class="nav-sidebar-toggle-open" aria-label="Toggle navigation" data-nav-sidebar-toggle>
        <span class="bar"></span>
        <span class="bar"></span>
        <span class="bar"></span>
      </div>
      <div class="nav-sidebar-bg" data-nav-sidebar-bg data-nav-sidebar-toggle></div>
      <div class="nav-sidebar" data-nav-sidebar>
        <div class="nav-sidebar-toggle-close" data-nav-sidebar-toggle>
          <span>&times;</span>
        </div>

        {% if current_user.is_authenticated %}
        <ul class="nav-links">
          <li><a class="" href="{{ url_for('home') }}" data-nav-sidebar-toggle>Home</a></li>
          <li><a class="" href="{{ url_for('wallets', username=current_user.username) }}" data-nav-sidebar-toggle>Wallets</a></li>
          <li><a class="" href="{{ url_for('reports', username=current_user.username) }}" data-nav-sidebar-toggle>Reports</a></li>
          <li><a class="" href="{{ url_for('history', username=current_user.username) }}" data-nav-sidebar-toggle>History</a></li>
        </ul>

        <div class="drpdwn" data-drpdwn>
          
          <div class="bttn bttn-outline" href="#" data-drpdwn-toggle>
            {{ current_user.username }}
          </div>
          
          <ul class="drpdwn-menu border-rad no-display" data-drpdwn-menu>
            <li><a class="drpdwn-item" href="{{ url_for('account', username=current_user.username) }}">Account</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="drpdwn-item border-rad" href="{{ url_for('auth.logout') }}">Log Out</a></li>
          </ul>

          <div class="drpdwn-close" data-drpdwn-close></div>

          <script>
            const drpdwnMenu = document.querySelector("[data-drpdwn-menu]");
            const drpdwnToggle = document.querySelector("[data-drpdwn-toggle]");
            const drpdwnClose = document.querySelector("[data-drpdwn-close]");
            
            drpdwnToggle.addEventListener("click", function() {
              if (drpdwnMenu.classList.contains("no-display")) {
                drpdwnMenu.classList.remove("no-display");
                drpdwnClose.style.visibility = "visible"
              } else {
                drpdwnMenu.classList.add("no-display");
              }
            });

            drpdwnClose.addEventListener("click", function() {
              drpdwnMenu.classList.add("no-display");
              drpdwnClose.style.visibility = "hidden"
            });
          </script>

        </div>

        <ul class="nav-bttns">
          <li><a class="bttn bttn-outline" href="{{ url_for('account', username=current_user.username) }}"><strong>{{ current_user.username }}</strong></a></li>
          <li><a class="bttn" href="{{ url_for('auth.logout') }}">Log Out</a></li>
        </ul>
        
        {% else %}
        <ul class="nav-links">
        </ul>
        <ul class="nav-bttns">
          <li><a class="bttn bttn-outline" href="{{ url_for('auth.login') }}">Log In</a></li>
          <li><a class="bttn" href="{{ url_for('auth.register') }}">Register</a></li>
        </ul>
        
        {% endif %}
      </div>        
    </nav>

		{% if get_flashed_messages() %}
    <div name="alert" class="alert" data-alert>
      <div class="alert-content">
        <ul>
          {% with messages = get_flashed_messages() %}                    
          {% for message in messages %}
          <li>{{ message }}</li>
          {% endfor %}
          {% endwith %}
        </ul>                    
        <div class="alert-close" data-alert-close>&times;</div>
      </div>
    </div>
		{% endif %}

    <main class="main">
      {% block main %}{% endblock %}      
    </main>
      
    <footer class="footer small text-center text-muted">
      <div>Footer</div>
      <a href="{{ url_for('resetdb') }}"><button class="btn btn-danger btn-sm">Reset DB</button></a>
    </footer>

	</body>

</html>